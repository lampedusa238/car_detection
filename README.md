# Детекция автомобилей с использованием YOLOv8 и оптического потока

## Описание
Этот проект использует модель YOLOv8 для детекции автомобилей на видео, а также вычисляет движение объектов с помощью оптического потока. 

Результаты обработки видео отображаются с визуальными рамками и информацией о движении автомобилей:
- красная рамка - автомобиль неподвижен;
- зеленая рамка - автомобиль движется.

Направление движения автомобилей указывается в консоль, а также выводится внутри каждой рамки.

![Результат работы](data/gif/output_demo.gif)

## Установка и настройка с использованием Poetry

Для управления зависимостями и виртуальной средой в проекте используется [Poetry](https://python-poetry.org/).

### Установка Poetry (если еще не установлен)

Следуйте инструкциям на [официальном сайте](https://python-poetry.org/docs/#installation).

### Установка проекта

1. Клонируйте репозиторий:
    ```bash
    git clone https://github.com/lampedusa238/car_detection.git
    cd car_detection
    ```

2. Установите зависимости с помощью Poetry:
    ```bash
    poetry install
    ```

3. Активируйте виртуальную среду:
    ```bash
    poetry shell
    ```
   
### Использование

Для обнаружения автомобилей на видео, необходимо указать путь для видео в `main.py`:
   ```Python
   if __name__ == '__main__':
       video_path = '{YOUR VIDEO PATH}'
       detect_cars(video_path)
   ```

При плохом обнаружении движущихся автомобилей можно изменить параметр `motion_magnitude` или использовать это более точную модель YOLOv8 (например, yolov8m.pt).